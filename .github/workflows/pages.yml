name: update pages #åç§° éšæ„

on: # è§¦å‘æ¡ä»¶
  push: # å½“æ¨é€çš„æ—¶å€™
    branches: [main] # åˆ†æ”¯ å¯ä»¥æœ‰å¤šä¸ª ä¸”ä¸º master è§¦å‘
    # paths: ['src/**'] # ä¸” æ¨é€çš„æ–‡ä»¶åœ¨æ­¤ç›®å½•ä¸‹ è§¦å‘

    # Allows you to run this workflow manually from the Actions tab
  workflow_dispatch:

# Sets permissions of the GITHUB_TOKEN to allow deployment to GitHub Pages
permissions:
  contents: read
  pages: write
  id-token: write

# Allow one concurrent deployment
concurrency:
  group: 'pages'
  cancel-in-progress: true

jobs: #è¦è¿è¡Œçš„ä»»åŠ¡
  build: #ä»»åŠ¡å éšæ„
    runs-on: ubuntu-latest # è¿è¡Œçš„æœºå™¨ç¯å¢ƒ å¯ä»¥æ˜¯ linux ç­‰ç­‰ å…·ä½“è¯·æŸ¥é˜…æ–‡æ¡£
    # ç”¨åˆ°çš„ node ç‰ˆæœ¬
    strategy:
      matrix:
        node-version: [16.14.0]
    # è¿è¡Œæ­¥éª¤
    steps:
      # ä¸€äº›æ£€æŸ¥ è¾“å‡º
      - name: Checkout
      - uses: actions/checkout@v3

      - name: Use Node.js ${{ matrix.node-version }}
        uses: actions/setup-node@v3
        with:
          node-version: ${{ matrix.node-version }}
      # å¼€å§‹ æ‰“åŒ…
      - name: Build
        # run ä¸‹é¢ æ˜¯éœ€è¦è¿è¡Œçš„å‘½ä»¤è¡Œ æŒ‰ç…§å‘½ä»¤è¡Œæ­¥éª¤æ‰§è¡Œ å…ˆå®‰è£…ä¾èµ– å† æ‰“åŒ… ä½ ä¹Ÿå¯ä»¥è‡ªå®šä¹‰
        run: |
          yarn
          yarn docs:build
      # å®Œæˆæ‰“åŒ…ä¹‹å ä½¿ç”¨ github-pages-deploy-action å»è‡ªå·±æŠŠæ‰“åŒ…åçš„äº§ç‰©å‘å¸ƒä¸Šå»
      # - name: Deploy ğŸš€
      #   uses: JamesIves/github-pages-deploy-action@v4.3.0
      #   with:
      #     branch: develop # å‘å¸ƒåˆ°å“ªä¸ªåˆ†æ”¯ï¼Ÿ
      #     folder: docs/.vuepress/dist # æ‰“åŒ…çš„æ–‡ä»¶ç›®å½•
      #     clean-exclude:
      #       | # å¿½ç•¥æ¸…é™¤çš„æ–‡ä»¶ å¯ä»¥æ˜¯æ–‡ä»¶åè·¯å¾„ç­‰ æ¯æ¬¡å‘å¸ƒå‰éƒ½ä¼šæ¸…é™¤æ‰€æœ‰æ–‡ä»¶æ‰€ä»¥éœ€è¦ å±è”½ä¸€äº›æ–‡ä»¶æˆ–è€…ç›®å½•ä¸è¦æ¸…é™¤ã€‚
      #       .gitignore
      - name: Setup Pages
        uses: actions/configure-pages@v1
      - name: Build with Jekyll
        uses: actions/jekyll-build-pages@v1
        with:
          source: docs/.vuepress/dist
          destination: docs/README.md
      - name: Upload artifact
        uses: actions/upload-pages-artifact@v1

  # Deployment job
  deploy:
    environment:
      name: github-pages
      url: ${{ steps.deployment.outputs.page_url }}
    runs-on: ubuntu-latest
    needs: build
    steps:
      - name: Deploy to GitHub Pages
        id: deployment
        uses: actions/deploy-pages@v1
